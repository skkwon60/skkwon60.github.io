---
layout: post
title:  "OAuth"
date:   2017-01-20 14:30:00 +0800
categories: [Front-end]
excerpt: 사용기를 바탕으로
tags:
  - 한국어
  - 사용기
 
---

# OAuth에 대하여

금주는 OAuth라는 로그인 방식에 대해서 배울 기회가 있었다. 일반적으로 여러 사이트에서 자주 보이던 로그인 방식에 대한 기술의 일종인데 이부분에 대해서 내가 배운바와 사용해본 후에 느낄 수 있었던 점에 대해서 이야기해 보겠다.

## OAuth란?

OAuth란 open standard for authorization의 약자로 인증 방식의 한가지이다. 보통 우리는 어떤 사이트를 이용하고자 할때 해당 사이트에 로그인 하는 과정을 거친다. 이때 일반적으로는 해당 사이트에 가입을 하고 가입한 아이디와 비밀번호를 바탕으로 유저 인증을 진행하게 된다. OAuth는 이러한 가입 과정을 필요로 하지 않는 유저 인증 방식이라고 생각하면 된다. 덕분에 OAuth는 보안 측면에서 봐도 우수하고, 사이트 관리자 입장에서도 따로 회원 가입에 대해서 신경써야 할 필요성을 없애주는 것으로 부담을 줄여 준다는 장점을 갖고 있다. 

## OAuth 작동 방법

OAuth를 통해서 유저 인증을 진행하는데 있어서 첫번째 순서는 OAuth를 이용할 사이트에 Get요청을 보내서 code를 발급받는 것이다. code를 발급 받았다면 이후에 해당 코드를 이용해서 사이트 형식에 맞게 요청을 보내서 access token이라는 것을 받아오게 된다. 이 access token이 OAuth에서 중요한 역할을 수행하게 된다. 다만 이 token을 사용할 때에는 해당 token이 만료기간을 지나지는 않았는지를 체크해야만 할 필요성이 있다. 만일 만료되었다면 새로운 token을 발급받아야만 한다. 반대로 token이 만료되지 않았다면 해당 사이트는 요청 결과로 ID를 돌려주게 된다. 우리는 이 ID를 이용하여 실제로 원하는 사이트를 이용하게 되는 것이다. 

## OAuth 이용의 주의점

OAuth에는 치명적인 약점이 존재할 수 있다고 한다. 이는 로그인 사이트를 제공하는 곳에서 해당 사이트를 유저 인증 방식으로 사용하고 있는 사이트의 유저 정보를 맘대로 들여다 볼 수 있는 위험성이 존재한다는 것이다. 실제로 OAuth가 작동되는 방식을 살펴보면 다소 로그인 제공자 쪽에 우위가 있을 수 있다는 것을 어렴풋이 알아볼 수 있다.<br><br>
때문에 우리는 이를 회피하기 위해서 OAuth에서 제공하는 State라는 것을 사용해야만 한다. state라는 랜덤 String을 생성하고 이를 최초 요청에 보내는 것으로 유저의 권한이 강해지는 방안이다. 추후에 이 state가 요청한 사이트에서 돌아오게 되는데 이를 기존의 state와 대조해 보는 것으로 공격 여부를 판단하게 되는 것이다. 

## OAuth를 제공하는 사이트들

대표적으로는 facebook이 있고, 그 외로 payco, twitter등이 있다. 

## 궁금점

지금은 OAuth를 javascript 상에서 최초 요청을 보내도록 만들어 놓았는데 이를 백엔드 코드 상에서 하나로 합쳐서 처리할 수 있는 방안이 있다고 들었다. 그러나 내용을 잘 이해를 못해서 그런 것인지는 몰라도 어떻게 해야만 할지가 잘 감이 안온다. 대충이라도 좋으니 예시를 좀 볼 수 있다면 좋겠다. 그리고 OAuth를 만드는 과정에서 Interface를 사용해서 구현하면 좋다는 이야기를 들었는데 결과적으로 다른 사이트들에 대해서 다른 코드를 전부 짜야하는 것은 결국 동일할 것인데 구지 Interface로 짜는 것에 이점이 있는 것인지 또한 궁금하다. 

